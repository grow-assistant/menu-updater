2025-03-09 18:38:31,557 - swoop_ai - INFO - Logging initialized at level INFO
2025-03-09 18:38:31,557 - swoop_ai - INFO - Log file: C:\Python\ai-menu-updater-refactored\logs\app.log
2025-03-09 18:38:31,557 - swoop_ai - INFO - Setting up AI API logging in session directory: logs\session_20250309_183829
2025-03-09 18:38:31,557 - swoop_ai - INFO - OpenAI logger configured: logs\session_20250309_183829\openai_categorization.log
2025-03-09 18:38:31,557 - swoop_ai - INFO - Google Gemini logger configured: logs\session_20250309_183829\google_gemini.log
2025-03-09 18:38:31,566 - swoop_ai - INFO - Summarization logger configured: logs\session_20250309_183829\summarization.log
2025-03-09 18:38:31,566 - swoop_ai - INFO - AI API logging configured for session: session_20250309_183829
2025-03-09 18:38:31,578 - services.utils.service_registry - INFO - Registered service: classification
2025-03-09 18:38:31,579 - services.utils.service_registry - INFO - Registered service: rules
2025-03-09 18:38:31,579 - services.utils.service_registry - INFO - Registered service: sql_generator
2025-03-09 18:38:31,580 - services.utils.service_registry - INFO - Registered service: execution
2025-03-09 18:38:31,582 - services.utils.service_registry - INFO - Registered service: response
2025-03-09 18:38:31,582 - services.rules.rules_service - INFO - Loading rules from storage
2025-03-09 18:38:31,585 - services.rules.rules_service - INFO - Assigned implementations to query_rules proxy functions
2025-03-09 18:38:31,591 - services.rules.rules_service - INFO - Loaded query rules module: menu_inquiry_rules
2025-03-09 18:38:31,592 - services.rules.rules_service - INFO - Loaded query rules module: order_history_rules
2025-03-09 18:38:31,594 - services.rules.rules_service - INFO - Loaded query rules module: order_ratings_rules
2025-03-09 18:38:31,595 - services.rules.rules_service - INFO - Loaded query rules module: popular_items_rules
2025-03-09 18:38:31,597 - services.rules.rules_service - INFO - Loaded query rules module: trend_analysis_rules
2025-03-09 18:38:31,598 - services.sql_generator.sql_generator_factory - INFO - Creating SQL generator of type: gemini
2025-03-09 18:38:31,599 - services.sql_generator.sql_generator_factory - INFO - Using Gemini for SQL generation.
2025-03-09 18:38:31,600 - services.sql_generator.gemini_sql_generator - INFO - SQLGenerator initialized with max_tokens=1024, temperature=0.2
2025-03-09 18:38:31,720 - services.execution.sql_executor - INFO - SQLExecutor initialized with pool_size=8, max_overflow=5
2025-03-09 18:38:31,761 - services.execution.sql_executor - INFO - SUCCESS - Database connection validated
2025-03-09 18:38:31,823 - services.response.response_generator - INFO - OpenAI client initialized successfully
2025-03-09 18:38:32,390 - services.response.response_generator - INFO - ElevenLabs TTS initialized successfully with 27 available voices
2025-03-09 18:38:32,390 - services.response.response_generator - INFO - Response generator personas not enabled. Using defaults - Text: 'professional', Verbal: 'casual'
2025-03-09 18:38:32,390 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 18:38:32,390 - services.response.response_generator - INFO - Verbal response generation mode: Dedicated verbal
2025-03-09 18:38:32,390 - services.response.response_generator - INFO - Found 1 template files
2025-03-09 18:38:32,390 - services.response.response_generator - INFO - Preloaded 2 templates
2025-03-09 18:38:33,761 - services.response.response_generator - INFO - === Response Generator Health Check ===
2025-03-09 18:38:33,762 - services.response.response_generator - INFO - OpenAI client: Available
2025-03-09 18:38:33,763 - services.response.response_generator - INFO - ElevenLabs client: Available
2025-03-09 18:38:33,764 - services.response.response_generator - INFO - Current persona: casual
2025-03-09 18:38:33,765 - services.response.response_generator - INFO - Text persona: professional
2025-03-09 18:38:33,766 - services.response.response_generator - INFO - Verbal persona: casual
2025-03-09 18:38:33,766 - services.response.response_generator - INFO - Generate dedicated verbal: True
2025-03-09 18:38:33,767 - services.response.response_generator - INFO - Default model: gpt-4o
2025-03-09 18:38:33,767 - services.response.response_generator - INFO - Verbal model: gpt-4o
2025-03-09 18:38:33,768 - services.response.response_generator - INFO - Max verbal sentences: 3
2025-03-09 18:38:33,768 - services.response.response_generator - INFO - Enable rich media: True
2025-03-09 18:38:33,769 - services.response.response_generator - INFO - =======================================
2025-03-09 18:38:34,234 - services.orchestrator.orchestrator - INFO - Initializing ElevenLabs for TTS during startup
2025-03-09 18:38:34,234 - services.orchestrator.orchestrator - INFO - Setting ElevenLabs API key (length: 51)
2025-03-09 18:38:34,405 - services.orchestrator.orchestrator - INFO - ElevenLabs API key validated successfully, found 27 voices
2025-03-09 18:38:34,405 - services.orchestrator.orchestrator - INFO - ElevenLabs initialized successfully for TTS
2025-03-09 18:38:43,960 - swoop_ai - INFO - Logging initialized at level INFO
2025-03-09 18:38:43,961 - swoop_ai - INFO - Log file: C:\Python\ai-menu-updater-refactored\logs\app.log
2025-03-09 18:38:43,962 - swoop_ai - INFO - Setting up AI API logging in session directory: logs\session_20250309_183829
2025-03-09 18:38:43,963 - swoop_ai - INFO - OpenAI logger configured: logs\session_20250309_183829\openai_categorization.log
2025-03-09 18:38:43,964 - swoop_ai - INFO - Google Gemini logger configured: logs\session_20250309_183829\google_gemini.log
2025-03-09 18:38:43,966 - swoop_ai - INFO - Summarization logger configured: logs\session_20250309_183829\summarization.log
2025-03-09 18:38:43,967 - swoop_ai - INFO - AI API logging configured for session: session_20250309_183829
2025-03-09 18:38:43,997 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - query: 'How many orders were completed on 2/21/2025?'
2025-03-09 18:38:43,999 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - context: {'session_history': [], 'user_preferences': {}, 'recent_queries': [], 'enable_verbal': True, 'persona': 'casual'}
2025-03-09 18:38:44,000 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - fast_mode: True
2025-03-09 18:38:44,001 - services.orchestrator.orchestrator - INFO - Processing query: 'How many orders were completed on 2/21/2025?' (ID: 261d11bd-520d-4ea0-9cef-6fa07dccc2ee)
2025-03-09 18:38:44,002 - services.orchestrator.orchestrator - INFO - Verbal response requested, disabling fast_mode (original fast_mode=True)
2025-03-09 18:38:44,004 - services.orchestrator.orchestrator - INFO - Performing health check on response generator
2025-03-09 18:38:44,006 - services.response.response_generator - INFO - === Response Generator Health Check ===
2025-03-09 18:38:44,007 - services.response.response_generator - INFO - OpenAI client: Available
2025-03-09 18:38:44,007 - services.response.response_generator - INFO - ElevenLabs client: Available
2025-03-09 18:38:44,008 - services.response.response_generator - INFO - Current persona: casual
2025-03-09 18:38:44,009 - services.response.response_generator - INFO - Text persona: professional
2025-03-09 18:38:44,010 - services.response.response_generator - INFO - Verbal persona: casual
2025-03-09 18:38:44,010 - services.response.response_generator - INFO - Generate dedicated verbal: True
2025-03-09 18:38:44,011 - services.response.response_generator - INFO - Default model: gpt-4o
2025-03-09 18:38:44,011 - services.response.response_generator - INFO - Verbal model: gpt-4o
2025-03-09 18:38:44,012 - services.response.response_generator - INFO - Max verbal sentences: 3
2025-03-09 18:38:44,013 - services.response.response_generator - INFO - Enable rich media: True
2025-03-09 18:38:44,014 - services.response.response_generator - INFO - =======================================
2025-03-09 18:38:44,552 - services.orchestrator.orchestrator - INFO - Response generator health check result: True
2025-03-09 18:38:45,817 - services.orchestrator.orchestrator - INFO - Query classified as: order_history
2025-03-09 18:38:45,818 - services.orchestrator.orchestrator - INFO - Time period identified: WHERE updated_at = '2025-02-21'
2025-03-09 18:38:45,819 - services.orchestrator.orchestrator - INFO - Constraints extracted from query: status: completed
2025-03-09 18:38:45,819 - services.rules.rules_service - INFO - Processing rules for category: order_history
2025-03-09 18:38:45,821 - services.rules.rules_service - INFO - Loaded 16 SQL patterns from directory: order_history
2025-03-09 18:38:45,821 - services.rules.rules_service - INFO - Added query-specific rules for category 'order_history' from module 'order_history_rules'
2025-03-09 18:38:45,824 - services.rules.rules_service - INFO - Loaded 16 SQL patterns from directory: order_history
2025-03-09 18:38:45,825 - services.sql_generator.gemini_sql_generator - INFO - Built SQL generation prompt with 0 examples and context for order_history
2025-03-09 18:38:45,826 - services.sql_generator.gemini_sql_generator - INFO - Generating SQL with model: gemini-2.0-flash, attempt: 1/3
2025-03-09 18:38:46,695 - services.execution.sql_executor - WARNING - Error executing SQL (attempt 1/3): (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 8: AND o.location_id = {location_id};
                            ^

[SQL: SELECT
COUNT(*) AS order_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::date = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-09 18:38:47,201 - services.execution.sql_executor - WARNING - Error executing SQL (attempt 2/3): (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 8: AND o.location_id = {location_id};
                            ^

[SQL: SELECT
COUNT(*) AS order_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::date = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-09 18:38:47,711 - services.execution.sql_executor - WARNING - Error executing SQL (attempt 3/3): (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 8: AND o.location_id = {location_id};
                            ^

[SQL: SELECT
COUNT(*) AS order_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::date = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-09 18:38:47,712 - services.execution.sql_executor - ERROR - SQL execution failed after 3 attempts: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 8: AND o.location_id = {location_id};
                            ^

[SQL: SELECT
COUNT(*) AS order_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::date = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-09 18:38:47,713 - services.execution.sql_executor - WARNING - Slow query detected (1.02s): SELECT
COUNT(*) AS order_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::date = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};...
2025-03-09 18:38:47,713 - services.orchestrator.orchestrator - WARNING - Query results were None or empty, cannot generate response
2025-03-09 18:38:47,713 - services.orchestrator.orchestrator - INFO - Query processing completed in 3.71s
2025-03-09 18:38:47,714 - services.orchestrator.orchestrator - INFO - 
                Performance Breakdown:
                - Classification: 1.26s
                - Rule Processing: 0.01s
                - SQL Generation: 0.86s
                - SQL Execution: 1.02s
                - Text Response: 0.00s
                - TTS Generation: 0.00s
                - Other/Unaccounted: 0.56s
                - Total Time: 3.71s
            
2025-03-09 18:38:47,714 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY OUTPUT - result: {'query_id': '261d11bd-520d-4ea0-9cef-6fa07dccc2ee', 'query': 'How many orders were completed on 2/21/2025?', 'category': 'order_history', 'response': None, 'response_model': None, 'execution_time': 3.7123589515686035, 'timestamp': '2025-03-09T18:38:47.713667', 'has_verbal': False, 'query_results': None}
2025-03-09 18:54:19,265 - swoop_ai - INFO - Logging initialized at level INFO
2025-03-09 18:54:19,265 - swoop_ai - INFO - Log file: C:\Python\ai-menu-updater-refactored\logs\app.log
2025-03-09 18:54:19,265 - swoop_ai - INFO - Setting up AI API logging in session directory: logs\session_20250309_185417
2025-03-09 18:54:19,265 - swoop_ai - INFO - OpenAI logger configured: logs\session_20250309_185417\openai_categorization.log
2025-03-09 18:54:19,272 - swoop_ai - INFO - Google Gemini logger configured: logs\session_20250309_185417\google_gemini.log
2025-03-09 18:54:19,272 - swoop_ai - INFO - Summarization logger configured: logs\session_20250309_185417\summarization.log
2025-03-09 18:54:19,274 - swoop_ai - INFO - AI API logging configured for session: session_20250309_185417
2025-03-09 18:54:19,287 - services.utils.service_registry - INFO - Registered service: classification
2025-03-09 18:54:19,288 - services.utils.service_registry - INFO - Registered service: rules
2025-03-09 18:54:19,288 - services.utils.service_registry - INFO - Registered service: sql_generator
2025-03-09 18:54:19,289 - services.utils.service_registry - INFO - Registered service: execution
2025-03-09 18:54:19,289 - services.utils.service_registry - INFO - Registered service: response
2025-03-09 18:54:19,289 - services.rules.rules_service - INFO - Loading rules from storage
2025-03-09 18:54:19,295 - services.rules.rules_service - INFO - Assigned implementations to query_rules proxy functions
2025-03-09 18:54:19,298 - services.rules.rules_service - INFO - Loaded query rules module: menu_inquiry_rules
2025-03-09 18:54:19,300 - services.rules.rules_service - INFO - Loaded query rules module: order_history_rules
2025-03-09 18:54:19,301 - services.rules.rules_service - INFO - Loaded query rules module: order_ratings_rules
2025-03-09 18:54:19,303 - services.rules.rules_service - INFO - Loaded query rules module: popular_items_rules
2025-03-09 18:54:19,305 - services.rules.rules_service - INFO - Loaded query rules module: trend_analysis_rules
2025-03-09 18:54:19,306 - services.sql_generator.sql_generator_factory - INFO - Creating SQL generator of type: gemini
2025-03-09 18:54:19,307 - services.sql_generator.sql_generator_factory - INFO - Using Gemini for SQL generation.
2025-03-09 18:54:19,308 - services.sql_generator.gemini_sql_generator - INFO - SQLGenerator initialized with max_tokens=1024, temperature=0.2
2025-03-09 18:54:19,437 - services.execution.sql_executor - INFO - SQLExecutor initialized with pool_size=8, max_overflow=5
2025-03-09 18:54:19,499 - services.execution.sql_executor - INFO - SUCCESS - Database connection validated
2025-03-09 18:54:19,559 - services.response.response_generator - INFO - OpenAI client initialized successfully
2025-03-09 18:54:19,755 - services.response.response_generator - INFO - ElevenLabs TTS initialized successfully with 27 available voices
2025-03-09 18:54:19,755 - services.response.response_generator - INFO - Response generator personas not enabled. Using defaults - Text: 'professional', Verbal: 'casual'
2025-03-09 18:54:19,755 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 18:54:19,755 - services.response.response_generator - INFO - Verbal response generation mode: Dedicated verbal
2025-03-09 18:54:19,755 - services.response.response_generator - INFO - Found 1 template files
2025-03-09 18:54:19,755 - services.response.response_generator - INFO - Preloaded 2 templates
2025-03-09 18:54:21,137 - services.response.response_generator - INFO - === Response Generator Health Check ===
2025-03-09 18:54:21,137 - services.response.response_generator - INFO - OpenAI client: Available
2025-03-09 18:54:21,137 - services.response.response_generator - INFO - ElevenLabs client: Available
2025-03-09 18:54:21,137 - services.response.response_generator - INFO - Current persona: casual
2025-03-09 18:54:21,145 - services.response.response_generator - INFO - Text persona: professional
2025-03-09 18:54:21,145 - services.response.response_generator - INFO - Verbal persona: casual
2025-03-09 18:54:21,145 - services.response.response_generator - INFO - Generate dedicated verbal: True
2025-03-09 18:54:21,145 - services.response.response_generator - INFO - Default model: gpt-4o
2025-03-09 18:54:21,145 - services.response.response_generator - INFO - Verbal model: gpt-4o
2025-03-09 18:54:21,145 - services.response.response_generator - INFO - Max verbal sentences: 3
2025-03-09 18:54:21,145 - services.response.response_generator - INFO - Enable rich media: True
2025-03-09 18:54:21,145 - services.response.response_generator - INFO - =======================================
2025-03-09 18:54:21,979 - services.orchestrator.orchestrator - INFO - Initializing ElevenLabs for TTS during startup
2025-03-09 18:54:21,980 - services.orchestrator.orchestrator - INFO - Setting ElevenLabs API key (length: 51)
2025-03-09 18:54:22,155 - services.orchestrator.orchestrator - INFO - ElevenLabs API key validated successfully, found 27 voices
2025-03-09 18:54:22,155 - services.orchestrator.orchestrator - INFO - ElevenLabs initialized successfully for TTS
2025-03-09 18:54:38,601 - swoop_ai - INFO - Logging initialized at level INFO
2025-03-09 18:54:38,602 - swoop_ai - INFO - Log file: C:\Python\ai-menu-updater-refactored\logs\app.log
2025-03-09 18:54:38,604 - swoop_ai - INFO - Setting up AI API logging in session directory: logs\session_20250309_185417
2025-03-09 18:54:38,605 - swoop_ai - INFO - OpenAI logger configured: logs\session_20250309_185417\openai_categorization.log
2025-03-09 18:54:38,607 - swoop_ai - INFO - Google Gemini logger configured: logs\session_20250309_185417\google_gemini.log
2025-03-09 18:54:38,608 - swoop_ai - INFO - Summarization logger configured: logs\session_20250309_185417\summarization.log
2025-03-09 18:54:38,609 - swoop_ai - INFO - AI API logging configured for session: session_20250309_185417
2025-03-09 18:54:38,640 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - query: 'How many orders were completed on 2/21/2025?'
2025-03-09 18:54:38,642 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - context: {'session_history': [], 'user_preferences': {}, 'recent_queries': [], 'enable_verbal': True, 'persona': 'casual'}
2025-03-09 18:54:38,644 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - fast_mode: True
2025-03-09 18:54:38,645 - services.orchestrator.orchestrator - INFO - Processing query: 'How many orders were completed on 2/21/2025?' (ID: b162690b-d0e0-4e9a-b8bb-bd603a74fd9e)
2025-03-09 18:54:38,647 - services.orchestrator.orchestrator - INFO - Verbal response requested, disabling fast_mode (original fast_mode=True)
2025-03-09 18:54:38,648 - services.orchestrator.orchestrator - INFO - Performing health check on response generator
2025-03-09 18:54:38,648 - services.response.response_generator - INFO - === Response Generator Health Check ===
2025-03-09 18:54:38,649 - services.response.response_generator - INFO - OpenAI client: Available
2025-03-09 18:54:38,650 - services.response.response_generator - INFO - ElevenLabs client: Available
2025-03-09 18:54:38,651 - services.response.response_generator - INFO - Current persona: casual
2025-03-09 18:54:38,651 - services.response.response_generator - INFO - Text persona: professional
2025-03-09 18:54:38,653 - services.response.response_generator - INFO - Verbal persona: casual
2025-03-09 18:54:38,653 - services.response.response_generator - INFO - Generate dedicated verbal: True
2025-03-09 18:54:38,654 - services.response.response_generator - INFO - Default model: gpt-4o
2025-03-09 18:54:38,654 - services.response.response_generator - INFO - Verbal model: gpt-4o
2025-03-09 18:54:38,655 - services.response.response_generator - INFO - Max verbal sentences: 3
2025-03-09 18:54:38,656 - services.response.response_generator - INFO - Enable rich media: True
2025-03-09 18:54:38,656 - services.response.response_generator - INFO - =======================================
2025-03-09 18:54:39,200 - services.orchestrator.orchestrator - INFO - Response generator health check result: True
2025-03-09 18:54:41,142 - services.orchestrator.orchestrator - INFO - Query classified as: order_history
2025-03-09 18:54:41,143 - services.orchestrator.orchestrator - INFO - Time period identified: WHERE updated_at = '2025-02-21'
2025-03-09 18:54:41,144 - services.orchestrator.orchestrator - INFO - Constraints extracted from query: status: completed
2025-03-09 18:54:41,144 - services.rules.rules_service - INFO - Processing rules for category: order_history
2025-03-09 18:54:41,146 - services.rules.rules_service - INFO - Loaded 16 SQL patterns from directory: order_history
2025-03-09 18:54:41,147 - services.rules.rules_service - INFO - Added query-specific rules for category 'order_history' from module 'order_history_rules'
2025-03-09 18:54:41,149 - services.rules.rules_service - INFO - Loaded 16 SQL patterns from directory: order_history
2025-03-09 18:54:41,149 - services.sql_generator.gemini_sql_generator - INFO - Built SQL generation prompt with 0 examples and context for order_history
2025-03-09 18:54:41,150 - services.sql_generator.gemini_sql_generator - INFO - Generating SQL with model: gemini-2.0-flash, attempt: 1/3
2025-03-09 18:54:41,986 - services.execution.sql_executor - WARNING - Error executing SQL (attempt 1/3): (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 8: AND o.location_id = {location_id};
                            ^

[SQL: SELECT
COUNT(*) AS completed_orders_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::DATE = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-09 18:54:42,504 - services.execution.sql_executor - WARNING - Error executing SQL (attempt 2/3): (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 8: AND o.location_id = {location_id};
                            ^

[SQL: SELECT
COUNT(*) AS completed_orders_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::DATE = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-09 18:54:43,022 - services.execution.sql_executor - WARNING - Error executing SQL (attempt 3/3): (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 8: AND o.location_id = {location_id};
                            ^

[SQL: SELECT
COUNT(*) AS completed_orders_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::DATE = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-09 18:54:43,023 - services.execution.sql_executor - ERROR - SQL execution failed after 3 attempts: (psycopg2.errors.SyntaxError) syntax error at or near "{"
LINE 8: AND o.location_id = {location_id};
                            ^

[SQL: SELECT
COUNT(*) AS completed_orders_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::DATE = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-03-09 18:54:43,024 - services.execution.sql_executor - WARNING - Slow query detected (1.04s): SELECT
COUNT(*) AS completed_orders_count
FROM
orders o
WHERE
(o.updated_at - INTERVAL '7 hours')::DATE = '2025-02-21'
AND o.status = 7
AND o.location_id = {location_id};...
2025-03-09 18:54:43,024 - services.orchestrator.orchestrator - WARNING - Query results were None or empty, cannot generate response
2025-03-09 18:54:43,025 - services.orchestrator.orchestrator - INFO - Query processing completed in 4.38s
2025-03-09 18:54:43,025 - services.orchestrator.orchestrator - INFO - 
                Performance Breakdown:
                - Classification: 1.94s
                - Rule Processing: 0.00s
                - SQL Generation: 0.83s
                - SQL Execution: 1.04s
                - Text Response: 0.00s
                - TTS Generation: 0.00s
                - Other/Unaccounted: 0.56s
                - Total Time: 4.38s
            
2025-03-09 18:54:43,026 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY OUTPUT - result: {'query_id': 'b162690b-d0e0-4e9a-b8bb-bd603a74fd9e', 'query': 'How many orders were completed on 2/21/2025?', 'category': 'order_history', 'response': None, 'response_model': None, 'execution_time': 4.379575729370117, 'timestamp': '2025-03-09T18:54:43.025061', 'has_verbal': False, 'query_results': None}
2025-03-09 19:00:10,035 - swoop_ai - INFO - Logging initialized at level INFO
2025-03-09 19:00:10,035 - swoop_ai - INFO - Log file: C:\Python\ai-menu-updater-refactored\logs\app.log
2025-03-09 19:00:10,035 - swoop_ai - INFO - Setting up AI API logging in session directory: logs\session_20250309_190008
2025-03-09 19:00:10,035 - swoop_ai - INFO - OpenAI logger configured: logs\session_20250309_190008\openai_categorization.log
2025-03-09 19:00:10,035 - swoop_ai - INFO - Google Gemini logger configured: logs\session_20250309_190008\google_gemini.log
2025-03-09 19:00:10,051 - swoop_ai - INFO - Summarization logger configured: logs\session_20250309_190008\summarization.log
2025-03-09 19:00:10,053 - swoop_ai - INFO - AI API logging configured for session: session_20250309_190008
2025-03-09 19:00:10,059 - services.utils.service_registry - INFO - Registered service: classification
2025-03-09 19:00:10,059 - services.utils.service_registry - INFO - Registered service: rules
2025-03-09 19:00:10,063 - services.utils.service_registry - INFO - Registered service: sql_generator
2025-03-09 19:00:10,063 - services.utils.service_registry - INFO - Registered service: execution
2025-03-09 19:00:10,064 - services.utils.service_registry - INFO - Registered service: response
2025-03-09 19:00:10,065 - services.rules.rules_service - INFO - Loading rules from storage
2025-03-09 19:00:10,071 - services.rules.rules_service - INFO - Assigned implementations to query_rules proxy functions
2025-03-09 19:00:10,074 - services.rules.rules_service - INFO - Loaded query rules module: menu_inquiry_rules
2025-03-09 19:00:10,075 - services.rules.rules_service - INFO - Loaded query rules module: order_history_rules
2025-03-09 19:00:10,076 - services.rules.rules_service - INFO - Loaded query rules module: order_ratings_rules
2025-03-09 19:00:10,077 - services.rules.rules_service - INFO - Loaded query rules module: popular_items_rules
2025-03-09 19:00:10,078 - services.rules.rules_service - INFO - Loaded query rules module: trend_analysis_rules
2025-03-09 19:00:10,080 - services.sql_generator.sql_generator_factory - INFO - Creating SQL generator of type: gemini
2025-03-09 19:00:10,080 - services.sql_generator.sql_generator_factory - INFO - Using Gemini for SQL generation.
2025-03-09 19:00:10,081 - services.sql_generator.gemini_sql_generator - INFO - SQLGenerator initialized with max_tokens=1024, temperature=0.2
2025-03-09 19:00:10,081 - services.sql_generator.gemini_sql_generator - INFO - Testing placeholder replacement on: SELECT * FROM orders WHERE location_id = {location_id}
2025-03-09 19:00:10,082 - services.sql_generator.gemini_sql_generator - INFO - Replaced location_id placeholder format '\{location_id\}' with actual value 62
2025-03-09 19:00:10,083 - services.sql_generator.gemini_sql_generator - WARNING - Location ID filtering missing in SQL query: SELECT * FROM orders WHERE location_id = 62
2025-03-09 19:00:10,084 - services.sql_generator.gemini_sql_generator - INFO - Location filter added to query: SELECT * FROM orders WHERE where where.location_id = 62 AND .location_id = 62 AND  location_id = 62
2025-03-09 19:00:10,085 - services.sql_generator.gemini_sql_generator - INFO - SQL after placeholder replacement: SELECT * FROM orders WHERE where where.location_id = 62 AND .location_id = 62 AND  location_id = 62
2025-03-09 19:00:10,086 - services.sql_generator.gemini_sql_generator - INFO - Location ID placeholder replacement successful: True
2025-03-09 19:00:10,087 - services.sql_generator.gemini_sql_generator - INFO - DEFAULT_LOCATION_ID value (62) is in result: True
2025-03-09 19:00:10,087 - services.sql_generator.gemini_sql_generator - INFO - Placeholder replacement verified successfully during initialization
2025-03-09 19:00:10,219 - services.execution.sql_executor - INFO - SQLExecutor initialized with pool_size=8, max_overflow=5
2025-03-09 19:00:10,253 - services.execution.sql_executor - INFO - SUCCESS - Database connection validated
2025-03-09 19:00:10,319 - services.response.response_generator - INFO - OpenAI client initialized successfully
2025-03-09 19:00:10,520 - services.response.response_generator - INFO - ElevenLabs TTS initialized successfully with 27 available voices
2025-03-09 19:00:10,520 - services.response.response_generator - INFO - Response generator personas not enabled. Using defaults - Text: 'professional', Verbal: 'casual'
2025-03-09 19:00:10,520 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 19:00:10,520 - services.response.response_generator - INFO - Verbal response generation mode: Dedicated verbal
2025-03-09 19:00:10,520 - services.response.response_generator - INFO - Found 1 template files
2025-03-09 19:00:10,520 - services.response.response_generator - INFO - Preloaded 2 templates
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - === Response Generator Health Check ===
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - OpenAI client: Available
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - ElevenLabs client: Available
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - Current persona: casual
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - Text persona: professional
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - Verbal persona: casual
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - Generate dedicated verbal: True
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - Default model: gpt-4o
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - Verbal model: gpt-4o
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - Max verbal sentences: 3
2025-03-09 19:00:12,000 - services.response.response_generator - INFO - Enable rich media: True
2025-03-09 19:00:12,009 - services.response.response_generator - INFO - =======================================
2025-03-09 19:00:13,036 - services.orchestrator.orchestrator - INFO - Initializing ElevenLabs for TTS during startup
2025-03-09 19:00:13,036 - services.orchestrator.orchestrator - INFO - Setting ElevenLabs API key (length: 51)
2025-03-09 19:00:13,223 - services.orchestrator.orchestrator - INFO - ElevenLabs API key validated successfully, found 27 voices
2025-03-09 19:00:13,224 - services.orchestrator.orchestrator - INFO - ElevenLabs initialized successfully for TTS
2025-03-09 19:00:25,494 - swoop_ai - INFO - Logging initialized at level INFO
2025-03-09 19:00:25,494 - swoop_ai - INFO - Log file: C:\Python\ai-menu-updater-refactored\logs\app.log
2025-03-09 19:00:25,496 - swoop_ai - INFO - Setting up AI API logging in session directory: logs\session_20250309_190008
2025-03-09 19:00:25,497 - swoop_ai - INFO - OpenAI logger configured: logs\session_20250309_190008\openai_categorization.log
2025-03-09 19:00:25,499 - swoop_ai - INFO - Google Gemini logger configured: logs\session_20250309_190008\google_gemini.log
2025-03-09 19:00:25,500 - swoop_ai - INFO - Summarization logger configured: logs\session_20250309_190008\summarization.log
2025-03-09 19:00:25,500 - swoop_ai - INFO - AI API logging configured for session: session_20250309_190008
2025-03-09 19:00:25,533 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - query: 'How many orders were completed on 2/21/2025?'
2025-03-09 19:00:25,534 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - context: {'session_history': [], 'user_preferences': {}, 'recent_queries': [], 'enable_verbal': True, 'persona': 'casual'}
2025-03-09 19:00:25,536 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - fast_mode: True
2025-03-09 19:00:25,537 - services.orchestrator.orchestrator - INFO - Processing query: 'How many orders were completed on 2/21/2025?' (ID: c6837c95-3ca3-4ebc-93ca-8f4cdb2cbaf6)
2025-03-09 19:00:25,538 - services.orchestrator.orchestrator - INFO - Verbal response requested, disabling fast_mode (original fast_mode=True)
2025-03-09 19:00:25,539 - services.orchestrator.orchestrator - INFO - Performing health check on response generator
2025-03-09 19:00:25,539 - services.response.response_generator - INFO - === Response Generator Health Check ===
2025-03-09 19:00:25,541 - services.response.response_generator - INFO - OpenAI client: Available
2025-03-09 19:00:25,542 - services.response.response_generator - INFO - ElevenLabs client: Available
2025-03-09 19:00:25,543 - services.response.response_generator - INFO - Current persona: casual
2025-03-09 19:00:25,544 - services.response.response_generator - INFO - Text persona: professional
2025-03-09 19:00:25,544 - services.response.response_generator - INFO - Verbal persona: casual
2025-03-09 19:00:25,544 - services.response.response_generator - INFO - Generate dedicated verbal: True
2025-03-09 19:00:25,545 - services.response.response_generator - INFO - Default model: gpt-4o
2025-03-09 19:00:25,545 - services.response.response_generator - INFO - Verbal model: gpt-4o
2025-03-09 19:00:25,546 - services.response.response_generator - INFO - Max verbal sentences: 3
2025-03-09 19:00:25,548 - services.response.response_generator - INFO - Enable rich media: True
2025-03-09 19:00:25,549 - services.response.response_generator - INFO - =======================================
2025-03-09 19:00:26,556 - services.orchestrator.orchestrator - INFO - Response generator health check result: True
2025-03-09 19:00:27,757 - services.orchestrator.orchestrator - INFO - Query classified as: order_history
2025-03-09 19:00:27,758 - services.orchestrator.orchestrator - INFO - Time period identified: WHERE updated_at = '2025-02-21'
2025-03-09 19:00:27,760 - services.orchestrator.orchestrator - INFO - Constraints extracted from query: status: completed
2025-03-09 19:00:27,760 - services.rules.rules_service - INFO - Processing rules for category: order_history
2025-03-09 19:00:27,762 - services.rules.rules_service - INFO - Loaded 16 SQL patterns from directory: order_history
2025-03-09 19:00:27,763 - services.rules.rules_service - INFO - Added query-specific rules for category 'order_history' from module 'order_history_rules'
2025-03-09 19:00:27,766 - services.rules.rules_service - INFO - Loaded 16 SQL patterns from directory: order_history
2025-03-09 19:00:27,766 - services.sql_generator.gemini_sql_generator - INFO - Built SQL generation prompt with 0 examples and context for order_history
2025-03-09 19:00:27,767 - services.sql_generator.gemini_sql_generator - INFO - Generating SQL with model: gemini-2.0-flash, attempt: 1/3
2025-03-09 19:00:28,546 - services.execution.sql_executor - INFO - SQL executed successfully: 1 rows affected/returned in 0.03s
2025-03-09 19:00:28,547 - services.orchestrator.orchestrator - INFO - Generating text and verbal response for query: 'How many orders were completed on 2/21/2025?'
2025-03-09 19:00:28,548 - services.response.response_generator - INFO - Starting generate_with_verbal for query: How many orders were completed on 2/21/2025?...
2025-03-09 19:00:28,549 - services.response.response_generator - INFO - SEQUENTIAL MODE: Running text response generation first
2025-03-09 19:00:28,549 - services.response.response_generator - INFO - Response generator persona set to 'professional' for all response types
2025-03-09 19:00:28,549 - services.response.response_generator - INFO - Current persona set to: professional
2025-03-09 19:00:28,550 - services.response.response_generator - INFO - Using text persona: professional for text response
2025-03-09 19:00:28,550 - services.response.response_generator - INFO - [API_CALL:a93a5f0b] Starting text response generation for query: 'How many orders were completed on 2/21/2025?...'
2025-03-09 19:00:28,552 - services.response.response_generator - INFO - [API_CALL:a93a5f0b] Category: order_history, Model: gpt-4o
2025-03-09 19:00:28,552 - services.response.response_generator - INFO - No specific template found for category: order_history, using default
2025-03-09 19:00:28,552 - services.response.response_generator - INFO - Using persona 'professional' for response generation
2025-03-09 19:00:28,554 - services.response.response_generator - INFO - Response generation prompt logged to: logs\ai_prompts\openai_response_11955fba.log
2025-03-09 19:00:28,555 - services.response.response_generator - INFO - Sending request to OpenAI API with model: gpt-4o
2025-03-09 19:00:29,873 - services.response.response_generator - INFO - [API_CALL:c2b8aa7e] openai.chat.completions.create - SUCCESS - 1.32s
2025-03-09 19:00:29,874 - services.response.response_generator - INFO - Text response generated successfully: 0 characters
2025-03-09 19:00:29,875 - services.response.response_generator - INFO - Response generator persona set to 'casual' for all response types
2025-03-09 19:00:29,876 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 19:00:29,876 - services.response.response_generator - INFO - SEQUENTIAL MODE: Now running verbal response generation
2025-03-09 19:00:29,877 - services.response.response_generator - INFO - Response generator persona set to 'casual' for all response types
2025-03-09 19:00:29,877 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 19:00:29,878 - services.response.response_generator - INFO - Using verbal persona: casual for verbal response
2025-03-09 19:00:29,878 - services.response.response_generator - INFO - Generating verbal text...
2025-03-09 19:00:29,879 - services.response.response_generator - INFO - Starting _generate_verbal_text for query: How many orders were completed on 2/21/2025?...
2025-03-09 19:00:29,879 - services.response.response_generator - INFO - Using dedicated concise verbal response generation
2025-03-09 19:00:29,879 - services.response.response_generator - INFO - Verbal prompt: Create a brief and clear spoken response for the question:
                "How many orders were com...
2025-03-09 19:00:29,880 - services.response.response_generator - INFO - Making OpenAI API call for verbal text with model: gpt-4o
2025-03-09 19:00:29,881 - services.response.response_generator - INFO - Using persona 'casual' for response generation
2025-03-09 19:00:30,868 - services.response.response_generator - INFO - Successfully generated verbal text: On February 21, 2025, we completed four orders. It...
2025-03-09 19:00:30,869 - services.response.response_generator - INFO - Generated verbal text (152 chars)
2025-03-09 19:00:30,870 - services.response.response_generator - INFO - Attempting to generate verbal audio...
2025-03-09 19:00:30,871 - services.response.response_generator - INFO - Attempting to generate TTS audio
2025-03-09 19:00:30,872 - services.response.response_generator - INFO - ElevenLabs module successfully imported
2025-03-09 19:00:30,872 - services.response.response_generator - INFO - Setting ElevenLabs API key
2025-03-09 19:00:30,872 - services.response.response_generator - INFO - Using ElevenLabs voice ID: UgBBYS2sOqTuMpoF3BR0
2025-03-09 19:00:30,873 - services.response.response_generator - INFO - Calling ElevenLabs API for text-to-speech conversion
2025-03-09 19:00:33,263 - services.response.response_generator - INFO - Successfully generated audio in 2.39s
2025-03-09 19:00:33,264 - services.response.response_generator - INFO - Successfully generated verbal audio
2025-03-09 19:00:33,264 - services.response.response_generator - INFO - Response generator persona set to 'casual' for all response types
2025-03-09 19:00:33,265 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 19:00:33,265 - services.response.response_generator - INFO - Added verbal audio to response
2025-03-09 19:00:33,266 - services.orchestrator.orchestrator - INFO - Verbal audio received from response generator
2025-03-09 19:00:33,266 - services.orchestrator.orchestrator - INFO - Added verbal audio to response
2025-03-09 19:00:33,268 - services.orchestrator.orchestrator - INFO - Query processing completed in 7.73s
2025-03-09 19:00:33,268 - services.orchestrator.orchestrator - INFO - 
                Performance Breakdown:
                - Classification: 1.20s
                - Rule Processing: 0.01s
                - SQL Generation: 0.75s
                - SQL Execution: 0.03s
                - Text Response: 4.72s
                - TTS Generation: 0.00s
                - Other/Unaccounted: 1.03s
                - Total Time: 7.73s
            
2025-03-09 19:00:33,269 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY OUTPUT - result: {'query_id': 'c6837c95-3ca3-4ebc-93ca-8f4cdb2cbaf6', 'query': 'How many orders were completed on 2/21/2025?', 'category': 'order_history', 'response': 'I found 4 completed order(s) on 2025-02-21.', 'response_model': 'gpt-4o', 'execution_time': 7.7290661334991455, 'timestamp': '2025-03-09T19:00:33.266066', 'has_verbal': True, 'query_results': [{'order_count': 4}], 'verbal_text': "On February 21, 2025, we completed four orders. It's great to see our customers enjoying their meals! If you have any other questions, feel free to ask."}
2025-03-09 19:00:53,569 - swoop_ai - INFO - Logging initialized at level INFO
2025-03-09 19:00:53,570 - swoop_ai - INFO - Log file: C:\Python\ai-menu-updater-refactored\logs\app.log
2025-03-09 19:00:53,571 - swoop_ai - INFO - Setting up AI API logging in session directory: logs\session_20250309_190008
2025-03-09 19:00:53,572 - swoop_ai - INFO - OpenAI logger configured: logs\session_20250309_190008\openai_categorization.log
2025-03-09 19:00:53,573 - swoop_ai - INFO - Google Gemini logger configured: logs\session_20250309_190008\google_gemini.log
2025-03-09 19:00:53,575 - swoop_ai - INFO - Summarization logger configured: logs\session_20250309_190008\summarization.log
2025-03-09 19:00:53,575 - swoop_ai - INFO - AI API logging configured for session: session_20250309_190008
2025-03-09 19:00:53,607 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - query: 'Who completed the orders?'
2025-03-09 19:00:53,610 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - context: {'session_history': [{'timestamp': datetime.datetime(2025, 3, 9, 19, 0, 33, 283494), 'query': 'How many orders were completed on 2/21/2025?', 'response': 'I found 4 completed order(s) on 2025-02-21.', 'category': 'order_history', 'sql_query': None, 'results': [{'order_count': 4}]}], 'user_preferences': {}, 'recent_queries': ['How many orders were completed on 2/21/2025?'], 'enable_verbal': True, 'persona': 'casual'}
2025-03-09 19:00:53,611 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY INPUT - fast_mode: True
2025-03-09 19:00:53,612 - services.orchestrator.orchestrator - INFO - Processing query: 'Who completed the orders?' (ID: 574572e2-8b3c-4ac9-9854-762e04a0322e)
2025-03-09 19:00:53,613 - services.orchestrator.orchestrator - INFO - Verbal response requested, disabling fast_mode (original fast_mode=True)
2025-03-09 19:00:53,614 - services.orchestrator.orchestrator - INFO - Performing health check on response generator
2025-03-09 19:00:53,615 - services.response.response_generator - INFO - === Response Generator Health Check ===
2025-03-09 19:00:53,615 - services.response.response_generator - INFO - OpenAI client: Available
2025-03-09 19:00:53,616 - services.response.response_generator - INFO - ElevenLabs client: Available
2025-03-09 19:00:53,617 - services.response.response_generator - INFO - Current persona: casual
2025-03-09 19:00:53,617 - services.response.response_generator - INFO - Text persona: casual
2025-03-09 19:00:53,618 - services.response.response_generator - INFO - Verbal persona: casual
2025-03-09 19:00:53,619 - services.response.response_generator - INFO - Generate dedicated verbal: True
2025-03-09 19:00:53,620 - services.response.response_generator - INFO - Default model: gpt-4o
2025-03-09 19:00:53,621 - services.response.response_generator - INFO - Verbal model: gpt-4o
2025-03-09 19:00:53,623 - services.response.response_generator - INFO - Max verbal sentences: 3
2025-03-09 19:00:53,623 - services.response.response_generator - INFO - Enable rich media: True
2025-03-09 19:00:53,624 - services.response.response_generator - INFO - =======================================
2025-03-09 19:00:54,205 - services.orchestrator.orchestrator - INFO - Response generator health check result: True
2025-03-09 19:00:54,913 - services.orchestrator.orchestrator - INFO - Query classified as: order_history
2025-03-09 19:00:54,914 - services.orchestrator.orchestrator - INFO - Time period identified: WHERE updated_at = '2025-02-21'
2025-03-09 19:00:54,915 - services.orchestrator.orchestrator - INFO - Constraints extracted from query: status: completed
2025-03-09 19:00:54,916 - services.rules.rules_service - INFO - Loaded 16 SQL patterns from directory: order_history
2025-03-09 19:00:54,917 - services.sql_generator.gemini_sql_generator - INFO - Built SQL generation prompt with 0 examples and context for order_history
2025-03-09 19:00:54,918 - services.sql_generator.gemini_sql_generator - INFO - Generating SQL with model: gemini-2.0-flash, attempt: 1/3
2025-03-09 19:00:55,965 - services.sql_generator.gemini_sql_generator - WARNING - SQL may still contain placeholders: SELECT DISTINCT
u.first_name,
u.last_name,
regexp_replace(u.phone, '(\d{3})(\d{3})(\d{4})', '(\1) \2-\3') AS user_phone
FROM
orders o
JOIN
users u ON o.customer_id = u.id
WHERE
o.location_id = 62
AND o.status = 7
AND (o.updated_at - INTERVAL '7 hours')::date = '2025-02-21';
2025-03-09 19:00:55,967 - services.sql_generator.gemini_sql_generator - INFO - Performed aggressive placeholder replacement: SELECT DISTINCT
u.first_name,
u.last_name,
regexp_replace(u.phone, '(\d62)(\d62)(\d62)', '(\1) \2-\3') AS user_phone
FROM
orders o
JOIN
users u ON o.customer_id = u.id
WHERE
o.location_id = 62
AND o.status = 7
AND (o.updated_at - INTERVAL '7 hours')::date = '2025-02-21';
2025-03-09 19:00:55,989 - services.execution.sql_executor - INFO - SQL executed successfully: 4 rows affected/returned in 0.02s
2025-03-09 19:00:55,989 - services.orchestrator.orchestrator - INFO - Generating text and verbal response for query: 'Who completed the orders?'
2025-03-09 19:00:55,989 - services.response.response_generator - INFO - Starting generate_with_verbal for query: Who completed the orders?...
2025-03-09 19:00:55,990 - services.response.response_generator - INFO - SEQUENTIAL MODE: Running text response generation first
2025-03-09 19:00:55,990 - services.response.response_generator - INFO - Response generator persona set to 'casual' for all response types
2025-03-09 19:00:55,990 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 19:00:55,991 - services.response.response_generator - INFO - Using text persona: casual for text response
2025-03-09 19:00:55,991 - services.response.response_generator - INFO - [API_CALL:41545b23] Starting text response generation for query: 'Who completed the orders?...'
2025-03-09 19:00:55,993 - services.response.response_generator - INFO - [API_CALL:41545b23] Category: order_history, Model: gpt-4o
2025-03-09 19:00:55,993 - services.response.response_generator - INFO - Using persona 'casual' for response generation
2025-03-09 19:00:55,995 - services.response.response_generator - INFO - Response generation prompt logged to: logs\ai_prompts\openai_response_ca84bb08.log
2025-03-09 19:00:55,995 - services.response.response_generator - INFO - Sending request to OpenAI API with model: gpt-4o
2025-03-09 19:01:00,799 - services.response.response_generator - INFO - [API_CALL:a2e4a752] openai.chat.completions.create - SUCCESS - 4.80s
2025-03-09 19:01:00,800 - services.response.response_generator - INFO - Text response generated successfully: 0 characters
2025-03-09 19:01:00,800 - services.response.response_generator - INFO - Response generator persona set to 'casual' for all response types
2025-03-09 19:01:00,801 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 19:01:00,802 - services.response.response_generator - INFO - SEQUENTIAL MODE: Now running verbal response generation
2025-03-09 19:01:00,802 - services.response.response_generator - INFO - Response generator persona set to 'casual' for all response types
2025-03-09 19:01:00,803 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 19:01:00,803 - services.response.response_generator - INFO - Using verbal persona: casual for verbal response
2025-03-09 19:01:00,804 - services.response.response_generator - INFO - Generating verbal text...
2025-03-09 19:01:00,804 - services.response.response_generator - INFO - Starting _generate_verbal_text for query: Who completed the orders?...
2025-03-09 19:01:00,804 - services.response.response_generator - INFO - Using dedicated concise verbal response generation
2025-03-09 19:01:00,805 - services.response.response_generator - INFO - Verbal prompt: Create a brief and clear spoken response for the question:
                "Who completed the orders...
2025-03-09 19:01:00,805 - services.response.response_generator - INFO - Making OpenAI API call for verbal text with model: gpt-4o
2025-03-09 19:01:00,806 - services.response.response_generator - INFO - Using persona 'casual' for response generation
2025-03-09 19:01:05,711 - services.response.response_generator - INFO - Successfully generated verbal text: The orders were completed by Alex Solis II, Brando...
2025-03-09 19:01:05,712 - services.response.response_generator - INFO - Generated verbal text (162 chars)
2025-03-09 19:01:05,713 - services.response.response_generator - INFO - Attempting to generate verbal audio...
2025-03-09 19:01:05,713 - services.response.response_generator - INFO - Attempting to generate TTS audio
2025-03-09 19:01:05,714 - services.response.response_generator - INFO - ElevenLabs module successfully imported
2025-03-09 19:01:05,715 - services.response.response_generator - INFO - Setting ElevenLabs API key
2025-03-09 19:01:05,715 - services.response.response_generator - INFO - Using ElevenLabs voice ID: UgBBYS2sOqTuMpoF3BR0
2025-03-09 19:01:05,716 - services.response.response_generator - INFO - Calling ElevenLabs API for text-to-speech conversion
2025-03-09 19:01:08,165 - services.response.response_generator - INFO - Successfully generated audio in 2.45s
2025-03-09 19:01:08,165 - services.response.response_generator - INFO - Successfully generated verbal audio
2025-03-09 19:01:08,166 - services.response.response_generator - INFO - Response generator persona set to 'casual' for all response types
2025-03-09 19:01:08,167 - services.response.response_generator - INFO - Current persona set to: casual
2025-03-09 19:01:08,167 - services.response.response_generator - INFO - Added verbal audio to response
2025-03-09 19:01:08,168 - services.orchestrator.orchestrator - INFO - Verbal audio received from response generator
2025-03-09 19:01:08,168 - services.orchestrator.orchestrator - INFO - Added verbal audio to response
2025-03-09 19:01:08,169 - services.orchestrator.orchestrator - INFO - Query processing completed in 14.56s
2025-03-09 19:01:08,169 - services.orchestrator.orchestrator - INFO - 
                Performance Breakdown:
                - Classification: 0.71s
                - Rule Processing: 0.00s
                - SQL Generation: 1.05s
                - SQL Execution: 0.02s
                - Text Response: 12.18s
                - TTS Generation: 0.00s
                - Other/Unaccounted: 0.60s
                - Total Time: 14.56s
            
2025-03-09 19:01:08,170 - services.orchestrator.orchestrator - INFO - PROCESS_QUERY OUTPUT - result: {'query_id': '574572e2-8b3c-4ac9-9854-762e04a0322e', 'query': 'Who completed the orders?', 'category': 'order_history', 'response': 'I found 0 completed order(s) on 2025-02-21.', 'response_model': 'gpt-4o', 'execution_time': 14.555806875228882, 'timestamp': '2025-03-09T19:01:08.168465', 'has_verbal': True, 'query_results': [{'first_name': 'Alex', 'last_name': 'Solis II', 'user_phone': '6269914893'}, {'first_name': 'Brandon', 'last_name': 'Devers', 'user_phone': '8593516220'}, {'first_name': 'MATT', 'last_name': 'AGOSTO', 'user_phone': '8435681199'}, {'first_name': 'Michael', 'last_name': 'Russell', 'user_phone': '8599833499'}], 'verbal_text': 'The orders were completed by Alex Solis II, Brandon Devers, Matt Agosto, and Michael Russell. If you need more details about any specific order, feel free to ask!'}
